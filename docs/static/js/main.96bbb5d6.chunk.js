(this["webpackJsonpzoom-downloader"]=this["webpackJsonpzoom-downloader"]||[]).push([[0],{142:function(e,t,n){},143:function(e,t,n){"use strict";n.r(t);var r,c=n(2),a=n.n(c),s=n(28),o=n.n(s),i=n(9),l=n(73),u=n(6),d=n(41),b=n(17),j=n.n(b),p=n(58),h=n(32),f=n(1),O=n(145),x=n(29),v=n(85),m=n(55),g=n.n(m);n(79);!function(e){e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.CONFLICT=409]="CONFLICT",e[e.CREATED=201]="CREATED",e[e.OK=200]="OK"}(r||(r={}));var w=n(4),_=function(e){e.isMobile;var t=e.token,n=(e.setToken,e.setUser,e.user),a=Object(u.g)(),s=Object(c.useState)(!1),o=Object(i.a)(s,2),l=o[0],b=o[1],m=Object(c.useState)([]),_=Object(i.a)(m,2),k=_[0],S=_[1],N=Object(c.useState)(0),y=Object(i.a)(N,2),E=y[0],R=y[1],T=Object(c.useState)(0),D=Object(i.a)(T,2),C=D[0],U=D[1],F=Object(c.useState)(0),A=Object(i.a)(F,2),W=A[0],I=A[1],L=Object(c.useState)(new Date("2016/1/1")),z=Object(i.a)(L,2),M=z[0],B=z[1],H=Object(c.useState)(new Date),q=Object(i.a)(H,2),P=q[0],K=q[1],J=Object(c.useState)(""),Y=Object(i.a)(J,2),Z=Y[0],V=Y[1],Q=Object(c.useState)(""),X=Object(i.a)(Q,2),$=X[0],G=X[1],ee=function(e){V(null==e?"This field is required":""),B(e)},te=function(e){G(null==e?"This field is required":""),K(e)},ne=function(e){return e.preventDefault()},re=function(){var e=Object(h.a)(j.a.mark((function e(){var c,s,o,i,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(M&&P){e.next=2;break}return e.abrupt("return");case 2:b(!0),c=[],s="",o=Object(f.default)(M);case 6:return e.next=8,fetch("https://free-cors-bypass.herokuapp.com/https://api.zoom.us/v2/users/".concat(n.id,"/recordings?from=").concat(Object(O.default)(o,"yyyy-MM-dd"),"&to=").concat(Object(O.default)(Object(x.default)(o,1),"yyyy-MM-dd"),"&next_page_token=").concat(s,"&page_size=300"),{headers:{Authorization:"Bearer ".concat(t),"content-type":"application/json"}});case 8:i=e.sent,e.t0=i.status,e.next=e.t0===r.OK?12:e.t0===r.UNAUTHORIZED?13:14;break;case 12:return e.abrupt("break",15);case 13:return e.abrupt("return",a.push("/user"));case 14:return e.abrupt("break",15);case 15:return e.next=17,i.json();case 17:l=e.sent,console.log(l),s||(o=Object(x.default)(o,1)),s=l.next_page_token,c=[].concat(Object(p.a)(c),Object(p.a)(l.meetings)),S(c);case 23:if(s||Object(v.default)(o,P)){e.next=6;break}case 24:b(!1);case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e,t=0,n=Object(d.a)(k);try{for(n.s();!(e=n.n()).done;){t+=e.value.recording_files.length}}catch(r){n.e(r)}finally{n.f()}console.log("HERE",k),R(t)}),[k]);var ce=function(){var e=Object(h.a)(j.a.mark((function e(){var n,r,c,a,s,o,i,l,u,p,h,f;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(M&&P&&0!==k.length){e.next=2;break}return e.abrupt("return");case 2:return b(!0),n=0,U(0),I(0),e.prev=6,e.next=9,window.showDirectoryPicker();case 9:r=e.sent,c=performance.now(),a=Object(d.a)(k),e.prev=12,a.s();case 14:if((s=a.n()).done){e.next=62;break}return o=s.value,e.next=18,r.getDirectoryHandle("".concat(o.topic," (").concat(o.id,")").replaceAll(/[\\/:*?"<>|]/g,"-"),{create:!0});case 18:i=e.sent,l=Object(d.a)(o.recording_files),e.prev=20,l.s();case 22:if((u=l.n()).done){e.next=52;break}return p=u.value,e.prev=24,e.next=27,i.getFileHandle("".concat(p.id,".").concat(p.file_extension));case 27:if(!e.sent){e.next=31;break}return U(++n),I((performance.now()-c)*E/n/1e3),e.abrupt("continue",50);case 31:e.next=35;break;case 33:e.prev=33,e.t0=e.catch(24);case 35:return e.next=37,i.getFileHandle("".concat(new Date(p.recording_start).toLocaleString()," to ").concat(new Date(p.recording_end).toLocaleString()," (").concat(p.id,").").concat(p.file_extension).replaceAll(/[\\/:*?"<>|]/g,"-"),{create:!0});case 37:return h=e.sent,e.next=40,fetch("https://free-cors-bypass.herokuapp.com/".concat(p.download_url,"?access_token=").concat(t));case 40:if(!(f=e.sent).body){e.next=48;break}return e.t1=f.body,e.next=45,h.createWritable();case 45:return e.t2=e.sent,e.next=48,e.t1.pipeTo.call(e.t1,e.t2);case 48:U(++n),I((performance.now()-c)*E/n/1e3);case 50:e.next=22;break;case 52:e.next=57;break;case 54:e.prev=54,e.t3=e.catch(20),l.e(e.t3);case 57:return e.prev=57,l.f(),e.finish(57);case 60:e.next=14;break;case 62:e.next=67;break;case 64:e.prev=64,e.t4=e.catch(12),a.e(e.t4);case 67:return e.prev=67,a.f(),e.finish(67);case 70:e.next=75;break;case 72:e.prev=72,e.t5=e.catch(6),console.error(e.t5);case 75:I(0),b(!1);case 77:case"end":return e.stop()}}),e,null,[[6,72],[12,64,67,70],[20,54,57,60],[24,33]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)("div",{className:"vbox gap padding",children:[Object(w.jsx)("h1",{children:"".concat(n.first_name," ").concat(n.last_name)}),Object(w.jsxs)("form",{onSubmit:function(e){e.preventDefault(),ce()},children:[Object(w.jsxs)("label",{onClick:ne,children:["Start Date",Object(w.jsx)(g.a,{selected:M,showYearDropdown:!0,showMonthDropdown:!0,closeOnScroll:function(e){return e.target===document},onChange:function(e){ee(e)},className:""!==Z?"error":""}),Object(w.jsx)("p",{className:"error",children:Z})]}),Object(w.jsxs)("label",{onClick:ne,children:["End Date",Object(w.jsx)(g.a,{selected:P,showYearDropdown:!0,showMonthDropdown:!0,closeOnScroll:function(e){return e.target===document},onChange:function(e){te(e)},className:""!==$?"error":""}),Object(w.jsx)("p",{className:"error",children:$})]}),Object(w.jsx)("div",{className:"vbox gap",children:Object(w.jsxs)("div",{className:"hbox gap",children:[Object(w.jsxs)("button",{className:"spacer hbox",disabled:l,type:"button",onClick:re,children:[Object(w.jsx)("div",{className:"spacer"}),l?Object(w.jsx)("div",{className:"spinner"}):"Load Meetings",l?Object(w.jsx)("p",{children:" ".concat(k.length)}):null,l?null:Object(w.jsx)("p",{children:" (".concat(k.length,")")}),Object(w.jsx)("div",{className:"spacer"})]}),Object(w.jsxs)("button",{className:"spacer hbox",disabled:l||0===k.length,children:[Object(w.jsx)("div",{className:"spacer"}),l?Object(w.jsx)("div",{children:Object(w.jsx)("div",{className:"spinner"})}):"Download Recordings",l?null:Object(w.jsx)("p",{children:E>0?" (".concat(C,"/").concat(E,")"):""}),l?Object(w.jsx)("p",{children:E>0?" ".concat(C,"/").concat(E," "):""}):null,Object(w.jsx)("p",{children:W>0?" (".concat(W.toFixed(2),"s remaining)"):""}),Object(w.jsx)("div",{className:"spacer"})]})]})})]})]})},k=n(72),S=n.n(k),N=function(e){e.isMobile;var t=e.token,n=e.setToken,a=e.setUser,s=e.user,o=Object(u.g)(),l=Object(c.useState)([]),d=Object(i.a)(l,2),b=d[0],p=d[1],f=Object(c.useState)(""),O=Object(i.a)(f,2),x=O[0],v=O[1],m=Object(c.useState)(""),g=Object(i.a)(m,2),_=g[0],k=g[1],N=Object(c.useState)(!1),y=Object(i.a)(N,2),E=y[0],R=y[1],T=function(e){0===e.trim().length?v("This field is required"):v(""),n(e)};return Object(c.useEffect)((function(){var e=0;return p([]),R(!1),""!==t.trim()?(R(!0),e=setTimeout(Object(h.a)(j.a.mark((function e(){var n,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://free-cors-bypass.herokuapp.com/https://api.zoom.us/v2/users?page_size=300",{headers:{Authorization:"Bearer ".concat(t),"content-type":"application/json"}});case 2:n=e.sent,R(!1),e.t0=n.status,e.next=e.t0===r.OK?7:e.t0===r.UNAUTHORIZED?14:e.t0===r.INTERNAL_SERVER_ERROR?16:18;break;case 7:return e.next=9,n.json();case 9:return c=e.sent,p(c.users),console.log(c),v(""),e.abrupt("break",19);case 14:return v("Invalid jwt"),e.abrupt("break",19);case 16:return k("Error: Please try again later."),e.abrupt("return",R(!1));case 18:return e.abrupt("break",19);case 19:case"end":return e.stop()}}),e)}))),1e3)):R(!1),function(){clearTimeout(e)}}),[t]),Object(w.jsxs)("form",{className:"padding",children:[Object(w.jsxs)("label",{children:["JWT",Object(w.jsx)("input",{className:""!==x?"error":"",onChange:function(e){T(e.target.value)},value:t}),Object(w.jsx)("p",{className:"error",children:x})]}),Object(w.jsx)("p",{children:"Users"}),Object(w.jsxs)("div",{className:"vbox gap",children:[E?Object(w.jsx)("div",{className:"spinner"}):null,b.map((function(e){return Object(w.jsx)("button",{type:"button",className:e.id===(null===s||void 0===s?void 0:s.id)?S.a.selected:"",onClick:function(){!function(e){a(e),o.push("/")}(e)},children:"".concat(e.first_name," ").concat(e.last_name)},e.id)}))]}),Object(w.jsx)("p",{className:"error",children:_})]})},y=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(null),s=Object(i.a)(a,2),o=s[0],d=s[1],b=Object(c.useState)(!1),j=Object(i.a)(b,2),p=j[0],h=j[1];return Object(c.useEffect)((function(){var e=sessionStorage.getItem("token");e&&r(e);var t=function(){h(window.matchMedia("(max-width: 768px)").matches)};return window.addEventListener("resize",t),t(),function(){window.removeEventListener("resize",t)}}),[]),Object(c.useEffect)((function(){sessionStorage.setItem("token",n),n||d(null)}),[n]),Object(w.jsx)(l.a,{children:Object(w.jsxs)(u.d,{children:[Object(w.jsx)(u.b,{path:"/user",children:Object(w.jsx)(N,{isMobile:p,token:n,setToken:r,setUser:d,user:o})}),Object(w.jsx)(u.b,{path:"/",children:n&&o?Object(w.jsx)(_,{isMobile:p,token:n,setToken:r,setUser:d,user:o}):Object(w.jsx)(u.a,{to:"/user"})})]})})},E=(n(142),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,149)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))}),R=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function T(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(y,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/zoom-downloader",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/zoom-downloader","/service-worker.js");R?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):T(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):T(t,e)}))}}(),E()},72:function(e,t,n){e.exports={secondaryColor:"userSelect_secondaryColor__1mEp7",tertiaryColor:"userSelect_tertiaryColor__15Yib",quaternaryColor:"userSelect_quaternaryColor__2NW1J",secondaryFillColor:"userSelect_secondaryFillColor__1RSfT",tertiaryFillColor:"userSelect_tertiaryFillColor__19YhX",quaternaryFillColor:"userSelect_quaternaryFillColor__1-h7N",gray:"userSelect_gray__1924d",maxWidth700:"userSelect_maxWidth700__3mxPn",maxWidth1100:"userSelect_maxWidth1100__1dWzX",maxWidth1400:"userSelect_maxWidth1400__3LmKO",selected:"userSelect_selected__2Uj_L"}}},[[143,1,2]]]);
//# sourceMappingURL=main.96bbb5d6.chunk.js.map